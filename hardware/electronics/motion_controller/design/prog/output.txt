
--------------------------------------------------------------------------------------------------------------------------------------------
* Equation #1

V1 - Vop   Vop - Vout
-------- = ----------
  Rin          Rf    

--------------------------------------------------------------------------------------------------------------------------------------------
* Equation #2

V2 - Vop   -Vop + Vref   Vop
-------- + ----------- = ---
  Rin          Rin        Rg

--------------------------------------------------------------------------------------------------------------------------------------------
* Solve equation #1 for Vop

      Rf*V1 + Rin*Vout
Vop = ----------------
          Rf + Rin    


--------------------------------------------------------------------------------------------------------------------------------------------
* Solve equation #2 for Vop

      Rg*(V2 + Vref)
Vop = --------------
        2*Rg + Rin  


--------------------------------------------------------------------------------------------------------------------------------------------
* Set expression for Vop equal to each other to get equation 3

Rf*V1 + Rin*Vout   Rg*(V2 + Vref)
---------------- = --------------
    Rf + Rin         2*Rg + Rin  


--------------------------------------------------------------------------------------------------------------------------------------------
* Solve equation 3 for Vout

       -2*Rf*Rg*V1 + Rf*Rg*V2 + Rf*Rg*Vref - Rf*Rin*V1 + Rg*Rin*V2 + Rg*Rin*Vref
Vout = -------------------------------------------------------------------------
                                    Rin*(2*Rg + Rin)                            


--------------------------------------------------------------------------------------------------------------------------------------------
* Define Vcom and Vdif as follows

            Vdif
V1 = Vcom - ----
             2  

            Vdif
V2 = Vcom + ----
             2  

--------------------------------------------------------------------------------------------------------------------------------------------
* Sub in expressions for V1 and V2  in terms of Vdif and Vcom

                            /       Vdif\         /       Vdif\          /       Vdif\                        /       Vdif\
       Rf*Rg*Vref - 2*Rf*Rg*|Vcom - ----| + Rf*Rg*|Vcom + ----| - Rf*Rin*|Vcom - ----| + Rg*Rin*Vref + Rg*Rin*|Vcom + ----|
                            \        2  /         \        2  /          \        2  /                        \        2  /
Vout = --------------------------------------------------------------------------------------------------------------------
                                                         Rin*(2*Rg + Rin)                                                  

--------------------------------------------------------------------------------------------------------------------------------------------
* Enumerate args of Vout expression LHS

args[0] = 

 1 
---
Rin

args[1] = 

    1     
----------
2*Rg + Rin

args[2] = 

                     /       Vdif\         /       Vdif\          /       Vdif\                        /       Vdif\
Rf*Rg*Vref - 2*Rf*Rg*|Vcom - ----| + Rf*Rg*|Vcom + ----| - Rf*Rin*|Vcom - ----| + Rg*Rin*Vref + Rg*Rin*|Vcom + ----|
                     \        2  /         \        2  /          \        2  /                        \        2  /

--------------------------------------------------------------------------------------------------------------------------------------------
* Examine numerator, which is arg[2]

                     /       Vdif\         /       Vdif\          /       Vdif\                        /       Vdif\
Rf*Rg*Vref - 2*Rf*Rg*|Vcom - ----| + Rf*Rg*|Vcom + ----| - Rf*Rin*|Vcom - ----| + Rg*Rin*Vref + Rg*Rin*|Vcom + ----|
                     \        2  /         \        2  /          \        2  /                        \        2  /

--------------------------------------------------------------------------------------------------------------------------------------------
* Exand and collect w.r.t Vdif, Vcom, Vref

                                       /3*Rf*Rg   Rf*Rin   Rg*Rin\                        
Vcom*(-Rf*Rg - Rf*Rin + Rg*Rin) + Vdif*|------- + ------ + ------| + Vref*(Rf*Rg + Rg*Rin)
                                       \   2        2        2   /                        

--------------------------------------------------------------------------------------------------------------------------------------------
* Get coefficient of Vcom

-Rf*Rg - Rf*Rin + Rg*Rin

--------------------------------------------------------------------------------------------------------------------------------------------
* Set Equal to zero and solve for Rg

-Rf*Rg - Rf*Rin + Rg*Rin = 0

--------------------------------------------------------------------------------------------------------------------------------------------
 Bias network resistor must satisfy this equation to get rid of Vcom

     -Rf*Rin 
Rg = --------
     Rf - Rin

--------------------------------------------------------------------------------------------------------------------------------------------
* Sub in value for Rg into expression for Vout and simplify to get expression for Vout

       Rf*(Vdif + Vref)
Vout = ----------------
             Rin       

